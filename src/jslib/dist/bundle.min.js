!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("OminiTracker",[],t):"object"==typeof exports?exports.OminiTracker=t():e.OminiTracker=t()}(this,(()=>(()=>{"use strict";var e={d:(t,i)=>{for(var n in i)e.o(i,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:i[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{default:()=>o});class i{constructor(e,t){this.url=e,this.key=t,this.endpoints={uid:"/uid",parkour:"/parkour",alive:"/alive"}}async getData({endpoint:e,params:t}){var i;t.key=this.key,i="?"+Object.keys(t).map((function(e){return e+"="+t[e]})).join("&");const n=await fetch(this.url+this.endpoints[e]+i,{method:method||"GET",headers:{"Content-Type":"application/json"},mode:"cors"});return await n.json()}async postDataJSON({endpoint:e,data:t}){t.key=this.key;const i=await fetch(this.url+this.endpoints[e],{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),mode:"cors"});return await i.json()}}class n{constructor(e){this.uid,this.device={browser:{name:void 0,version:void 0},os:void 0,type:void 0},this.lang,this.camefrom=void 0,this.page={title:void 0,urlpath:void 0,search:void 0,performance:void 0},this.host=document.location.origin,this.api=e}getUid(){if(document){if(document.cookie.indexOf("Om_uid")>-1){var e=document.cookie.split("Om_uid=")[1].split(";")[0];e=this.validateUid_fetch(e),document.cookie="Om_uid="+e+"; max-age=31536000; samesite=strict"}else e=this.validateUid_fetch(""),document.cookie="Om_uid="+e+"; max-age=31536000; samesite=strict";return e}return!1}getPageInfo(){this.page.title=document.title,this.page.urlpath=window.location.origin+window.location.pathname,this.page.search=window.location.search,this.page.performance=window.performance.timing.domContentLoadedEventEnd-window.performance.timing.navigationStart}getDeviceInfo(){let e=navigator.userAgentData.brands;e=e.filter((e=>-1===e.brand.indexOf("Brand")&&-1===e.brand.indexOf("Chromium")))[0];const t={name:e.brand,version:e.version};var i,n=navigator.platform;n=n.indexOf("Win32")>-1?"Windows 64-bit":n.indexOf("Win16")>-1?"Windows 32-bit":n.indexOf("Mac")>-1?"Mac":n.indexOf("Android")>-1||n.indexOf("Linux armv7l")>-1?"Android":n.indexOf("Linux")>-1?"Linux":n.indexOf("iPhone")>-1?"iPhone":n.indexOf("iPad")>-1?"iPad":n.indexOf("Nintendo")>-1?"Nintendo":n.indexOf("PlayStation")>-1?"PlayStation":n.indexOf("BlackBerry")>-1?"BlackBerry":"unknown",["iPhone","iPad","Android","BlackBerry"].includes(n)&&(i="mobile"),["iPad"].includes(n)&&(i="tablet"),["Windows 64-bit","Mac","Linux","Windows 32-bit"].includes(n)&&(i="desktop"),["Nintendo","PlayStation"].includes(n)&&(i="console"),this.device={browser:t,os:n,type:i}}getLanguage(){this.lang=navigator.language}getPrevPage(){const e=document.referrer;""!==e&&(this.camefrom=e)}init(){this.getDeviceInfo(),this.getLanguage(),this.uid=this.getUid(),this.getPageInfo(),this.initTracker(),this.getPrevPage(),this.PageInfo_fetch()}initTracker(){var e=new Date,t=Math.floor(e.getTime()/1e3);window.addEventListener("beforeunload",(e=>{let i=new Date,n=Math.floor(i.getTime()/1e3)-t;this.leavePage_fetch(n)})),document.addEventListener("click",(e=>{})),this.isAlive_fetch(),setInterval((()=>{this.isAlive_fetch()}),2e4)}validateUid_fetch(e){return"12345abcdef6789ghij"}leavePage_fetch(e){console.log(e)}isAlive_fetch(){let e=new Date;Math.floor(e.getTime()/1e3)}PageInfo_fetch(){}}const o=class{constructor(e){this.api=new i("http://127.0.0.1:5000/",e),this.user=new n(this.api)}initTracker(){this.user.init(),console.log(this.user)}};return t.default})()));
